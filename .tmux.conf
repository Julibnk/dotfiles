unbind r
bind r source-file ~/.tmux.conf; display "Config reloaded!"

set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"

set -g allow-passthrough on
set -ga update-environment TERM
set -ga update-environment TERM_PROGRAM
set -ga update-environment KITTY_PID

set -g base-index 1
set -g prefix C-space
set -g mouse on
set -g renumber-windows on
set -g set-clipboard on
set-option -g status-position top
setw -g mode-keys vi
set -g set-titles on

unbind %
bind - split-window -c "#{pane_current_path}"
unbind '"'
bind v split-window -h -c "#{pane_current_path}"
bind w kill-pane
bind ' ' choose-tree -s
bind t new-window -c "#{pane_current_path}"

bind h previous-window
bind l next-window
bind o last-window
bind-key -r f run-shell "tmux neww ~/.config/tmux-sessionizer/tmux-sessionizer"

# ── Plugins ──────────────────────────────────────────────────
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'christoomey/vim-tmux-navigator'

# persist tmux sessions after computer restart
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @resurrect-capture-pane-contents 'on'

# automatically saves sessions every 15 minutes (must be last plugin)
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @continuum-restore 'on'

# ── Theme (from kitty current-theme) ─────────────────────────
KAN_BG="#14171d"
KAN_FG="#C5C9C7"
KAN_MUTED="#A4A7A4"
KAN_SURFACE="#22262D"
KAN_HIGHLIGHT="#2A3038"
KAN_BLUE="#7FB4CA"
KAN_WAVE_BLUE="#7AA89F"
KAN_OLD_WHITE="#C5C9C7"

# ── Pane borders ─────────────────────────────────────────────
set -g pane-border-lines single
set -g pane-border-indicators colour
set -g pane-border-style "fg=$KAN_HIGHLIGHT"
set -g pane-active-border-style "fg=$KAN_WAVE_BLUE"

# ── Status bar ───────────────────────────────────────────────
set -g status-style "bg=default,fg=$KAN_MUTED"
set -g status-left "#[bg=$KAN_BLUE,fg=$KAN_BG,bold] [#{@kitty_letter}] #(tmux display-message -p '#{session_name}' | tr a-z A-Z) #[default] "
set -g status-left-length 30
set -g status-right ""
set -g status-justify centre

# ── Window tabs ──────────────────────────────────────────────
set -g window-status-format "#[fg=$KAN_MUTED]  #I:#W "
set -g window-status-current-format "#[fg=$KAN_FG]  [#I:#W] "
set -g window-status-separator ""

# ── Messages & mode ──────────────────────────────────────────
set -g message-style "bg=$KAN_SURFACE,fg=$KAN_FG"
set -g mode-style "bg=$KAN_WAVE_BLUE,fg=$KAN_FG"

# ── Kitty letter indicator ────────────────────────────────────
set-hook -g client-attached 'run-shell "~/.tmux/kitty-letter.sh"'
set-hook -g session-created 'run-shell "~/.tmux/kitty-letter.sh"'

run '~/.tmux/plugins/tpm/tpm'
